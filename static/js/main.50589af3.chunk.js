(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{25:function(e,a,n){e.exports=n(55)},36:function(e,a,n){},51:function(e,a,n){},52:function(e,a,n){},53:function(e,a,n){},54:function(e,a,n){},55:function(e,a,n){"use strict";n.r(a);var t=n(0),r=n.n(t),s=n(14),o=n.n(s),c=n(4),l=n(5),i=n(15),u=n(7),p=n(6),d=n(3),m=(n(36),n(24)),g=n.n(m),h="pub-c-f8b92af1-f2ce-4048-ae86-6de257c060c4",y="sub-c-6e0270de-84ac-11ea-b883-d2d532c9a1bf",f=(n(48),n(49),n(2)),b=n(8),v=n.n(b),C=n(10),P=n(20),k=n(9),w=n(1),O=n.n(w),T=(n(51),n(52),function(e){Object(u.a)(n,e);var a=Object(p.a)(n);function n(){return Object(c.a)(this,n),a.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return this.props.card?this.props.card.isRevealed?r.a.createElement("div",{className:"overlay"},r.a.createElement("p",{className:"x"},"X"),r.a.createElement("div",{className:"card ".concat(this.props.card.name.toLowerCase()," revealed")},r.a.createElement("p",{className:"card-name"},this.props.card.name.toUpperCase()),r.a.createElement("img",{className:"portrait",src:"./images/".concat(this.props.card.name.toLowerCase(),".png"),alt:this.props.card.name}),r.a.createElement("div",{className:"card-info"},r.a.createElement("p",null,this.props.card.description)))):r.a.createElement("div",{className:"card ".concat(this.props.card.name.toLowerCase())},r.a.createElement("p",{className:"card-name"},this.props.card.name.toUpperCase()),r.a.createElement("img",{className:"portrait",src:"./images/".concat(this.props.card.name.toLowerCase(),".png"),alt:this.props.card.name}),r.a.createElement("div",{className:"card-info"},r.a.createElement("p",null,this.props.card.description))):r.a.createElement("div",{className:"card"},r.a.createElement("img",{className:"cardback",src:"./images/cardback.png",alt:"cardback"}))}}]),n}(r.a.Component)),E=Object(d.b)()(T),B=function(e){Object(u.a)(n,e);var a=Object(p.a)(n);function n(){var e;Object(c.a)(this,n);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).isYourTurn=function(){return e.props.activePlayer.id===e.props.player.id},e.handleClickAction=function(a){switch(console.log("Attempting to use "+a),a){case"Income":e.props.treasury>=1?(e.updateCoins(1),e.updateTreasury(-1),e.endTurn()):(O.a.fire("Not enough coins in Treasury!"),console.error("Not enough coins in Treasury"));break;case"Foreign Aid":e.props.treasury>=2?e.alertPlayers(a,void 0,"Duke"):(O.a.fire("Not enough coins in Treasury!"),console.error("Not enough coins in Treasury"));break;case"Tax":e.props.treasury>=3?e.alertPlayers(a,"Duke",void 0):(O.a.fire("Not enough coins in Treasury!"),console.error("Not enough coins in Treasury"));break;case"Coup":e.props.player.coins>=7?e.targetPlayer(a):O.a.fire("You need 7 coins to Coup.");break;case"Assassinate":e.props.player.coins>=3?e.targetPlayer(a,"Assassin","Contessa"):O.a.fire("You need 3 coins to Assassinate.");break;case"Exchange":e.alertPlayers(a,"Ambassador",void 0);break;case"Steal":e.targetPlayer(a,"Captain","Ambassador","Captain");break;default:console.error("Invalid player action")}},e.updatePlayer=function(){e.props.pubnub.publish({message:{type:"updatePlayer",player:e.props.player},channel:e.props.gameChannel})},e.updateTreasury=function(a){e.props.pubnub.publish({message:{type:"updateTreasury",treasury:e.props.treasury+a},channel:e.props.gameChannel})},e.updateCoins=function(){var a=Object(C.a)(v.a.mark((function a(n){return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.props.updateCoins(n);case 2:e.updatePlayer();case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.targetPlayer=function(a){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,t=arguments.length,r=new Array(t>2?t-2:0),s=2;s<t;s++)r[s-2]=arguments[s];console.log("Using ".concat(a,". Choose a player to target.")),O.a.fire({title:"Choose an opponent to use ".concat(a," on."),showConfirmButton:!1,showCancelButton:!0,allowOutsideClick:!1,timer:1e4,timerProgressBar:!0,onBeforeOpen:function(){var t=O.a.getActions();e.props.players.filter((function(a){return a.id!==e.props.player.id&&!a.gameOver})).forEach((function(s){var o=document.createElement("button");o.innerText=s.username,o.className="swal2-confirm swal2-styled",o.addEventListener("click",(function(){console.log(s.id),O.a.close(),e.props.pubnub.publish({message:{type:"target",action:a,associatedCard:n,counterCards:r,targetPlayerId:s.id},channel:e.props.gameChannel})})),t.append(o)}))}})},e.alertPlayers=function(a,n,t){e.props.pubnub.publish({message:{type:"alert",action:a,associatedCard:n,counterCard:t},channel:e.props.gameChannel})},e.endTurn=function(){e.props.pubnub.publish({message:{type:"endTurn"},channel:e.props.gameChannel})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this,a=this.props.player,n=[];for(var t in this.props.player.actions)n.push(this.props.player.actions[t]);return r.a.createElement("div",{className:"player-container"},r.a.createElement("div",{className:"player-name-hand-coin-container"},r.a.createElement("div",{className:"player-name-coins-container"},r.a.createElement("p",{className:"player-name"},a.username),r.a.createElement("p",{className:"coins"},"Coins: ",a.coins)),r.a.createElement("div",{className:"player-hand-container"},r.a.createElement("p",null,"Hand"),r.a.createElement("div",{className:"player-hand"},a.hand.map((function(e){return r.a.createElement(E,{key:e.id,card:e})}))))),r.a.createElement("table",{id:"actions"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Action"),r.a.createElement("th",null,"Character"),r.a.createElement("th",{className:"effect"},"Effect"),r.a.createElement("th",null,"Counteraction")),n.map((function(a){return r.a.createElement("tr",{className:"action",key:a.action},r.a.createElement("td",null,r.a.createElement("button",{onClick:function(a){return e.handleClickAction(a.target.value)},id:a.action,value:a.action,disabled:e.isYourTurn()?"":"disabled"},a.action)),r.a.createElement("td",{className:a.character},a.character?a.character:"X"),r.a.createElement("td",null,a.effect?a.effect:"X"),r.a.createElement("td",null,a.counteraction?a.counteraction:"X"))})))))}}]),n}(r.a.Component),I=Object(d.b)((function(e){return{pubnub:e.connectionReducer.pubnub,gameChannel:e.connectionReducer.gameChannel,isHost:e.connectionReducer.isHost,players:e.gameReducer.players,deck:e.gameReducer.deck,treasury:e.gameReducer.treasury,player:e.playerReducer,activePlayer:e.gameReducer.activePlayer}}),(function(e){return{endTurn:function(){return e({type:"endTurn"})},updateCoins:function(a){return e({type:"updateCoins",amt:a})},changeTreasury:function(a){return e({type:"changeTreasury",amt:a})}}}))(B),j=function(e){Object(u.a)(n,e);var a=Object(p.a)(n);function n(){var e;Object(c.a)(this,n);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).getId=function(e){return console.log(e),e},e}return Object(l.a)(n,[{key:"render",value:function(){}}]),n}(r.a.Component),x=Object(d.b)((function(e){return{player:e.playerReducer,players:e.gameReducer.players}}))(j),A=(n(53),function(e){Object(u.a)(n,e);var a=Object(p.a)(n);function n(){return Object(c.a)(this,n),a.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this,a=this.props.players.filter((function(a){return a.id!==e.props.player.id}));return r.a.createElement("div",{className:"opponents-container"},r.a.createElement("p",{className:"opponents-title"},"Opponents"),r.a.createElement("div",{className:"opponents"},a.map((function(e){return r.a.createElement(x,{key:e.id,opponent:e})}))))}}]),n}(r.a.Component)),R=Object(d.b)((function(e){return{player:e.playerReducer,players:e.gameReducer.players}}))(A),N=(n(54),function(e){Object(u.a)(n,e);var a=Object(p.a)(n);function n(){var e;Object(c.a)(this,n);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).initializeGame=function(a){var n=e.shuffleDeck(e.props.deck);e.distributeCards(n)},e.shuffleDeck=function(){for(var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(k.a)(e.props.deck),n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=a.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),s=[a[r],a[t]];a[t]=s[0],a[r]=s[1]}if(n){var o=a.shift();return e.updateDeck(a),o}return e.updateDeck(a),a},e.updateDeck=function(a){e.props.pubnub.publish({message:{type:"updateDeck",updatedDeck:a},channel:e.props.gameChannel})},e.distributeCards=function(a){var n,t=Object(P.a)(e.props.players);try{for(t.s();!(n=t.n()).done;){var r=n.value,s=a.shift(),o=a.shift();e.props.pubnub.publish({message:{type:"updateHand",playerId:r.id,cards:[s,o]},channel:e.props.gameChannel})}}catch(c){t.e(c)}finally{t.f()}e.updateDeck(a)},e.isYourTurn=function(){return e.props.activePlayer.id===e.props.player.id},e.aOrAn=function(e){return/[aeiouAEIOU]/.test(e.charAt(0))?"an":"a"},e.updatePlayer=function(){e.props.pubnub.publish({message:{type:"updatePlayer",player:e.props.player},channel:e.props.gameChannel})},e.updateTreasury=function(a){e.props.pubnub.publish({message:{type:"updateTreasury",treasury:e.props.treasury+a},channel:e.props.gameChannel})},e.updateCoins=function(){var a=Object(C.a)(v.a.mark((function a(n){return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.props.updateCoins(n);case 2:e.updatePlayer();case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.useAction=function(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;switch(console.log("Using "+a),console.log("Target player ID: "+n),a){case"Foreign Aid":e.updateCoins(2),e.updateTreasury(-2),e.endTurn();break;case"Tax":e.updateCoins(3),e.updateTreasury(-3),e.endTurn();break;case"Steal":var t=2,r=e.props.players.find((function(e){return e.id===n})).coins-2;r<0&&(t+=r),e.updateCoins(t);case"Coup":case"Assassinate":e.props.pubnub.publish({message:{type:"useTargetedAction",action:a,targetPlayerId:n},channel:e.props.gameChannel});break;case"Exchange":var s=e.props.player.hand.filter((function(e){return!1===e.isRevealed})).length,o=e.props.deck.shift(),c=e.props.deck.shift();console.log(o,c),O.a.fire({title:"Choose ".concat(s," card(s) to keep.")});break;default:console.error("Invalid action.")}},e.loseCard=function(){1!==e.props.player.hand.filter((function(e){return!0===e.isRevealed})).length?O.a.fire({title:"Pick a card to lose.",focusConfirm:!1,showCancelButton:!0,cancelButtonColor:"#3085d6",confirmButtonText:"Lose ".concat(e.props.player.hand[0].name),cancelButtonText:"Lose ".concat(e.props.player.hand[1].name),allowOutsideClick:!1,allowEscapeKey:!1,timer:1e4,timerProgressBar:!0,html:"<span class='swal2-text'>Losing a random card in <b></b></span>",onBeforeOpen:function(){setInterval((function(){var e=O.a.getContent();if(e){var a=e.querySelector("b");a&&O.a.getTimerLeft()&&(a.textContent=Math.ceil(O.a.getTimerLeft()/1e3))}}),100)}}).then((function(a){var n;n=a.value?0:"cancel"===a.dismiss?1:Math.round(Math.random()),O.a.fire({title:"Lost ".concat(e.props.player.hand[n].name,"!"),timer:1500,showConfirmButton:!1}).then((function(a){e.props.revealCard(n),e.updatePlayer(),e.endTurn()}))})):e.gameOver()},e.getNewCard=function(a,n){var t=e.props.player.hand.find((function(e){return e.name===a}));e.props.deck.push(t);var r=e.shuffleDeck(e.props.deck,!0);console.log("You shuffled in your ".concat(t.name," and got ").concat(e.aOrAn(r.name)," ").concat(r.name,"!")),O.a.fire({title:"You shuffled in your ".concat(t.name," and got ").concat(e.aOrAn(r.name)," ").concat(r.name,"!"),timer:2e3,showConfirmButton:!1}).then(n);var s=Object(k.a)(e.props.player.hand);s[s.findIndex((function(e){return e.id===t.id}))]=r,e.props.updateHand(s),e.updatePlayer()},e.endTurn=function(){e.props.pubnub.publish({message:{type:"endTurn"},channel:e.props.gameChannel})},e.gameOver=Object(C.a)(v.a.mark((function a(){var n,t;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return O.a.close(),O.a.fire({title:"Game over, man!",showConfirmButton:!1,allowOutsideClick:!1}),n=Object(k.a)(e.props.player.hand),t=e.props.player.hand[0].isRevealed?1:0,n[t]=Object(f.a)({},n[t],{isRevealed:!0}),e.props.updateHand(n),a.next=8,e.props.gameOver();case 8:return a.next=10,e.updatePlayer();case 10:e.endTurn();case 11:case"end":return a.stop()}}),a)}))),e.testMsg=function(a){e.props.pubnub.publish({message:{type:"log",text:a},channel:e.props.gameChannel})},e.hereNow=function(){e.props.pubnub.hereNow({channels:[e.props.gameChannel]}).then(console.log)},e.logPlayers=function(){console.log(e.props.players)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e,a=this;this.props.isHost&&this.initializeGame(),this.props.pubnub.getMessage(this.props.gameChannel,function(){var n=Object(C.a)(v.a.mark((function n(t){var r,s,o,c,l,i,u,p;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.message.type,n.next="updateDeck"===n.t0?3:"updatePlayer"===n.t0?5:"changeTreasury"===n.t0?7:"updateTreasury"===n.t0?9:"updateHand"===n.t0?11:"endTurn"===n.t0?14:"target"===n.t0?20:"alert"===n.t0?23:"counter"===n.t0?25:"challenge"===n.t0?27:"challengedPlayerWon"===n.t0?29:"challengedPlayerLost"===n.t0?31:"useTargetedAction"===n.t0?33:"log"===n.t0?51:53;break;case 3:return a.props.updateDeck(t.message.updatedDeck),n.abrupt("break",55);case 5:return a.props.updatePlayer(t.message.player),n.abrupt("break",55);case 7:return a.props.changeTreasury(t.message.amt),n.abrupt("break",55);case 9:return a.props.updateTreasury(t.message.treasury),n.abrupt("break",55);case 11:return a.props.setActivePlayer(),t.message.playerId===a.props.player.id&&(a.props.updateHand(t.message.cards),a.updatePlayer()),n.abrupt("break",55);case 14:return r=a.props.activePlayer.id,a.props.endTurn(),a.props.setActivePlayer(),a.props.activePlayer.id===r&&a.isYourTurn()&&(O.a.close(),O.a.fire({title:"u win gj gg",confirmButtonText:"New Game?",allowOutsideClick:!1})),console.log("".concat(a.props.players[a.props.whosTurnIsIt].username,"'s turn.")),n.abrupt("break",55);case 20:return e=a.props.players.find((function(e){return e.id===t.message.targetPlayerId})),"Coup"===t.message.action?a.isYourTurn()&&(a.updateCoins(-7),a.updateTreasury(7),O.a.fire({title:"You spent 7 coins and Couped ".concat(e.username,"!"),showConfirmButton:!1,timer:2e3}),a.useAction(t.message.action,e.id)):a.props.player.id===e.id?(s=void 0,O.a.fire({title:"".concat(a.props.activePlayer.username," is trying to use ").concat(t.message.action," on you with ").concat(a.aOrAn(t.message.associatedCard)," ").concat(t.message.associatedCard,"!"),timer:1e4,timerProgressBar:!0,confirmButtonText:"CHALLENGE",showCancelButton:!0,cancelButtonText:"Let ".concat(a.props.activePlayer.username," use ").concat(t.message.action,". :("),html:"<span class='swal2-text'>Letting ".concat(a.props.activePlayer.username," use ").concat(t.message.action," in <b></b></span>"),onBeforeOpen:function(){setInterval((function(){var e=O.a.getContent();if(e){var a=e.querySelector("b");a&&O.a.getTimerLeft()&&(a.textContent=Math.ceil(O.a.getTimerLeft()/1e3))}}),100);var e,a=O.a.getActions(),n=Object(P.a)(t.message.counterCards);try{var r=function(){var n=e.value,t=document.createElement("button");t.innerHTML="BLOCK with ".concat(n),t.className="swal2-confirm swal2-styled",t.addEventListener("click",(function(){s=n,O.a.close()})),a.prepend(t)};for(n.s();!(e=n.n()).done;)r()}catch(o){n.e(o)}finally{n.f()}}}).then((function(e){s?(console.log("Attempting to block with a(n) ".concat(s,".")),a.props.pubnub.publish({message:{type:"counter",action:t.message.action,counterCard:s,counteredPlayerId:a.props.activePlayer.id,counteredPlayerUn:a.props.activePlayer.username,counteringPlayerId:a.props.player.id,counteringPlayerUn:a.props.player.username},channel:a.props.gameChannel})):e.value?(console.log("Sending challenge to "+t.message.counteringPlayerUn),a.props.pubnub.publish({message:{type:"challenge",challengedPlayerId:a.props.activePlayer.id,challengedPlayerUn:a.props.activePlayer.username,challengingPlayerId:a.props.player.id,challengingPlayerUn:a.props.player.username,challengedCard:t.message.associatedCard,action:t.message.action},channel:a.props.gameChannel})):e.dismiss&&console.log("ok :(")}))):a.isYourTurn()&&(o=!0,c="You Stole 2 coins from ".concat(e.username,"!"),"Assassinate"===t.message.action&&(a.updateCoins(-3),a.updateTreasury(3),c="You spent 3 coins and Assassinated ".concat(e.username,"!"),o=!1),O.a.fire({title:"Waiting for ".concat(e.username,"."),showConfirmButton:!1,allowOutsideClick:!1,timer:1e4,timerProgressBar:!0}).then((function(n){"timer"===n.dismiss&&(O.a.fire({title:c,showConfirmButton:!1,timer:1500,icon:"success"}),a.useAction(t.message.action,e.id),o&&a.endTurn())}))),n.abrupt("break",55);case 23:return a.isYourTurn()||a.props.player.gameOver?a.isYourTurn()&&O.a.fire({title:"Waiting for other players.",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,timer:1e4,timerProgressBar:!0}).then((function(e){"timer"===e.dismiss&&(O.a.fire({title:"You use ".concat(t.message.action,"!"),showConfirmButton:!1,timer:1500,icon:"success"}),a.useAction(t.message.action))})):!t.message.associatedCard&&t.message.counterCard?O.a.fire({title:"".concat(a.props.activePlayer.username," is trying to use ").concat(t.message.action,"!"),timer:1e4,timerProgressBar:!0,showCancelButton:!0,cancelButtonText:"Let ".concat(a.props.activePlayer.username," use ").concat(t.message.action,"... this time."),confirmButtonText:"BLOCK with ".concat(a.aOrAn(t.message.counterCard)," ").concat(t.message.counterCard,"."),html:"<span class='swal2-text'>Letting ".concat(a.props.activePlayer.username," use ").concat(t.message.action," in <b></b></span>"),onBeforeOpen:function(){setInterval((function(){var e=O.a.getContent();if(e){var a=e.querySelector("b");a&&O.a.getTimerLeft()&&(a.textContent=Math.ceil(O.a.getTimerLeft()/1e3))}}),100)}}).then((function(e){e.value?a.props.pubnub.publish({message:{type:"counter",action:t.message.action,counterCard:t.message.counterCard,counteredPlayerId:a.props.activePlayer.id,counteredPlayerUn:a.props.activePlayer.username,counteringPlayerId:a.props.player.id,counteringPlayerUn:a.props.player.username},channel:a.props.gameChannel}):console.log("Letting it slide")})):t.message.associatedCard&&!t.message.counterCard?O.a.fire({title:"".concat(a.props.activePlayer.username," is trying to use ").concat(t.message.action," with ").concat(a.aOrAn(t.message.associatedCard)," ").concat(t.message.associatedCard,"!"),timer:1e4,timerProgressBar:!0,showCancelButton:!0,cancelButtonText:"Let ".concat(a.props.activePlayer.username," use ").concat(t.message.action,"... this time."),confirmButtonText:"CHALLENGE",html:"<span class='swal2-text'>Letting ".concat(a.props.activePlayer.username," use ").concat(t.message.action," in <b></b></span>"),onBeforeOpen:function(){setInterval((function(){var e=O.a.getContent();if(e){var a=e.querySelector("b");a&&O.a.getTimerLeft()&&(a.textContent=Math.ceil(O.a.getTimerLeft()/1e3))}}),100)}}).then((function(e){e.value?(console.log("Sending challenge to "+a.props.activePlayer.username),a.props.pubnub.publish({message:{type:"challenge",challengedPlayerId:a.props.activePlayer.id,challengedPlayerUn:a.props.activePlayer.username,challengingPlayerId:a.props.player.id,challengingPlayerUn:a.props.player.username,challengedCard:t.message.associatedCard,action:t.message.action},channel:a.props.gameChannel})):console.log("Letting it slide")})):t.message.associatedCard&&t.message.counterCard,n.abrupt("break",55);case 25:return a.props.player.id===t.message.counteredPlayerId?(O.a.close(),O.a.fire({title:"".concat(t.message.counteringPlayerUn," is trying to BLOCK your ").concat(t.message.action," with ").concat(a.aOrAn(t.message.counterCard)," ").concat(t.message.counterCard,"!"),showCancelButton:!0,cancelButtonText:"Back down",confirmButtonText:"CHALLENGE",allowOutsideClick:!1,allowEscapeKey:!1,timer:1e4,timerProgressBar:!0,html:"<span class='swal2-text'>Backing down in <b></b></span>",onBeforeOpen:function(){var e=O.a.getContent();setInterval((function(){if(e){var a=e.querySelector("b");a&&O.a.getTimerLeft()&&(a.textContent=Math.ceil(O.a.getTimerLeft()/1e3))}}),100)}}).then((function(e){e.value?(console.log("Sending challenge to "+t.message.counteringPlayerUn),a.props.pubnub.publish({message:{type:"challenge",challengedPlayerId:t.message.counteringPlayerId,challengedPlayerUn:t.message.counteringPlayerUn,challengingPlayerId:a.props.player.id,challengingPlayerUn:a.props.player.username,challengedCard:t.message.counterCard,action:t.message.action},channel:a.props.gameChannel})):e.dismiss&&(console.log("Where's your honor??"),a.endTurn())}))):a.props.player.id===t.message.counteringPlayerId?(console.log("You have attempted to block ".concat(t.message.counteredPlayerUn,"'s ").concat(t.message.action,"!")),O.a.fire({title:"You have attempted to block ".concat(t.message.counteredPlayerUn,"'s ").concat(t.message.action,"!"),timer:1e4,timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1}).then((function(e){"timer"===e.dismiss&&O.a.fire({title:"You blocked ".concat(t.message.counteredPlayerUn,"'s ").concat(t.message.action,"!"),icon:"success",timer:1500,timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1})}))):(console.log("".concat(t.message.counteringPlayerUn," has attempted to block ").concat(t.message.counteredPlayerUn,".")),a.props.player.gameOver||O.a.close()),n.abrupt("break",55);case 27:return a.props.player.id===t.message.challengedPlayerId?(O.a.close(),(l=a.props.player.hand.find((function(e){return e.name===t.message.challengedCard})))&&!l.isRevealed?O.a.fire({title:"".concat(t.message.challengingPlayerUn," challenged you!"),showCancelButton:!0,confirmButtonText:"Show my ".concat(t.message.challengedCard,"."),cancelButtonText:"Lose a card (Hint: don't do this)"}).then((function(e){e.value?a.props.pubnub.publish({message:{type:"challengedPlayerWon",challengedPlayerId:t.message.challengedPlayerId,challengedPlayerUn:t.message.challengedPlayerUn,challengingPlayerId:t.message.challengingPlayerId,challengingPlayerUn:t.message.challengingPlayerUn,challengedCard:t.message.challengedCard,action:t.message.action},channel:a.props.gameChannel}):e.dismiss&&a.props.pubnub.publish({message:{type:"challengedPlayerLost",challengedPlayerId:t.message.challengedPlayerId,challengedPlayerUn:t.message.challengedPlayerUn,challengingPlayerId:t.message.challengingPlayerId,challengingPlayerUn:t.message.challengingPlayerUn,challengedCard:t.message.challengedCard,action:t.message.action},channel:a.props.gameChannel})})):O.a.fire({title:"You were called out!",timer:1500,timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1}).then((function(e){a.props.pubnub.publish({message:{type:"challengedPlayerLost",challengedPlayerId:t.message.challengedPlayerId,challengedPlayerUn:t.message.challengedPlayerUn,challengingPlayerId:t.message.challengingPlayerId,challengingPlayerUn:t.message.challengingPlayerUn,challengedCard:t.message.challengedCard,action:t.message.action},channel:a.props.gameChannel})}))):a.props.player.id===t.message.challengingPlayerId?(console.log("You challenged ".concat(t.message.challengedPlayerUn,"'s ").concat(t.message.challengedCard,"!")),O.a.fire({title:"You challenged ".concat(t.message.challengedPlayerUn,"'s ").concat(t.message.challengedCard,"!"),showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1})):(console.log("".concat(t.message.challengedPlayerUn," has been challenged by ").concat(t.message.challengingPlayerUn,".")),a.props.player.gameOver||O.a.close()),n.abrupt("break",55);case 29:return a.props.player.id===t.message.challengedPlayerId?a.isYourTurn()?O.a.fire({title:"You show your ".concat(t.message.challengedCard,", winning the challenge!"),text:"You use ".concat(t.message.action," and ").concat(t.message.challengingPlayerUn," loses a card."),icon:"success",timer:1e4,timerProgressBar:!0}).then((function(e){a.getNewCard(t.message.challengedCard,(function(){return a.useAction(t.message.action,t.message.challengingPlayerId)}))})):a.isYourTurn()||O.a.fire({title:"You show your ".concat(t.message.challengedCard,", winning the challenge!"),text:"".concat(t.message.challengingPlayerUn," loses a card and doesn't get to ").concat(t.message.action,"."),icon:"success",timer:1e4,timerProgressBar:!0}).then((function(e){return a.getNewCard(t.message.challengedCard)})):a.props.player.id===t.message.challengingPlayerId&&(1===a.props.player.hand.filter((function(e){return!0===e.isRevealed})).length?O.a.fire({title:"".concat(t.message.challengedPlayerUn," had ").concat(a.aOrAn(t.message.challengedCard)," ").concat(t.message.challengedCard,"!"),timer:2e3,showConfirmButton:!1,allowOutsideClick:!1}).then((function(e){return a.gameOver()})):(O.a.close(),O.a.fire({title:"".concat(t.message.challengedPlayerUn," had ").concat(a.aOrAn(t.message.challengedCard)," ").concat(t.message.challengedCard,"! You lost the challenge!"),text:"You lose a card.",icon:"error",allowEscapeKey:!1,allowOutsideClick:!1,timer:1e4,timerProgressBar:!0}).then((function(e){return a.loseCard()})))),n.abrupt("break",55);case 31:return a.props.player.id===t.message.challengedPlayerId?1===a.props.player.hand.filter((function(e){return!0===e.isRevealed})).length?a.gameOver():O.a.fire({title:"You lost the challenge!",text:"You lose a card.",icon:"error",allowEscapeKey:!1,allowOutsideClick:!1,timer:1e4,timerProgressBar:!0}).then((function(e){return a.loseCard()})):a.props.player.id===t.message.challengingPlayerId&&(a.isYourTurn()?(a.useAction(t.message.action,t.message.challengedPlayerId),O.a.fire({title:"You won the challenge! You use ".concat(t.message.action,"."),text:"".concat(t.message.challengedPlayerUn," loses a card."),icon:"success",timer:1e4,timerProgressBar:!0})):a.isYourTurn()||O.a.fire({title:"You won the challenge! You blocked ".concat(t.message.challengedPlayerUn,"'s ").concat(t.message.action,"!"),text:"".concat(t.message.challengedPlayerUn," loses a card."),icon:"success",timer:1e4,timerProgressBar:!0})),n.abrupt("break",55);case 33:if(a.props.player.id!==t.message.targetPlayerId){n.next=49;break}i="".concat(a.props.activePlayer.username," Couped you!"),n.t1=t.message.action,n.next="Assassinate"===n.t1?38:"Coup"===n.t1?39:"Steal"===n.t1?41:46;break;case 38:i="".concat(a.props.activePlayer.username," Assassinated you!");case 39:return O.a.fire({title:i,showConfirmButton:!1,allowOutsideClick:!1,timer:2e3}).then((function(e){a.loseCard()})),n.abrupt("break",47);case 41:return u=2,(p=a.props.player.coins-2)<0&&(u+=p),a.updateCoins(-u),n.abrupt("break",47);case 46:console.error("Invalid Targeted Action: ".concat(t.message.action));case 47:n.next=50;break;case 49:a.isYourTurn();case 50:return n.abrupt("break",55);case 51:return console.log(t.message.text),n.abrupt("break",55);case 53:console.error("Unknown game message."),console.log(t);case 55:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),this.props.changeTreasury(-2*this.props.players.length)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"game"},r.a.createElement(R,null),r.a.createElement("p",{className:"whose-turn"},"Whose turn: ",this.props.activePlayer.username?this.props.activePlayer.username:null),r.a.createElement("div",{className:"treasury"},r.a.createElement("p",null,"Treasury: ",this.props.treasury," coins")),r.a.createElement("div",{className:"court-deck"},r.a.createElement(E,null),r.a.createElement("p",null,"Court Deck: ",this.props.deck.length," cards")),r.a.createElement("br",null),r.a.createElement(I,null))}}]),n}(r.a.Component)),U=Object(d.b)((function(e){return{pubnub:e.connectionReducer.pubnub,gameChannel:e.connectionReducer.gameChannel,isHost:e.connectionReducer.isHost,player:e.playerReducer,players:e.gameReducer.players,deck:e.gameReducer.deck,treasury:e.gameReducer.treasury,whosTurnIsIt:e.gameReducer.whosTurnIsIt,activePlayer:e.gameReducer.activePlayer}}),(function(e){return{initDeck:function(a){return e({type:"initializeDeck",cards:a})},updateDeck:function(a){return e({type:"updateDeck",updatedDeck:a})},updatePlayer:function(a){return e({type:"updatePlayer",player:a})},getNewCard:function(a){return e({type:"getNewCard",card:a})},updateHand:function(a){return e({type:"updateHand",cards:a})},changeTreasury:function(a){return e({type:"changeTreasury",amt:a})},updateCoins:function(a){return e({type:"updateCoins",amt:a})},updateTreasury:function(a){return e({type:"updateTreasury",treasury:a})},setActivePlayer:function(){return e({type:"setActivePlayer"})},revealCard:function(a){return e({type:"revealCard",i:a})},endTurn:function(){return e({type:"endTurn"})},gameOver:function(){return e({type:"gameOver"})}}}))(N),L=function(e){Object(u.a)(n,e);var a=Object(p.a)(n);function n(){var e;Object(c.a)(this,n);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=a.call.apply(a,[this].concat(r))).createLobby=function(){console.log("You are the host!");var a=Math.random().toString(36).slice(2,6).toUpperCase();e.props.pubnub.hereNow({channels:["coup-lobby-".concat(a)]}).then((function(n){0===n.totalOccupancy?(e.props.setHost(),e.subscribeToLobby(a)):(console.log("Trying a different roomId"),e.createLobby())}))},e.joinLobby=function(a){a.preventDefault();var n=a.target[0].value.toUpperCase();0!==n.length?e.props.pubnub.hereNow({channels:["coup-lobby-".concat(n)]}).then((function(a){0===a.totalOccupancy?(console.error("Room doesn't exist!"),O.a.fire("Room doesn't exist!")):a.totalOccupancy<5?(console.log("You are not the host."),e.subscribeToLobby(n)):(console.error("Room is full!"),O.a.fire("Room is full!"))})):O.a.fire("Please enter a Room ID")},e.subscribeToLobby=function(a){var n="coup-lobby-".concat(a);e.props.setRoomId(a),e.props.joinLobby(n),console.log("Joining lobbyChannel: ".concat(n)),e.props.pubnub.subscribe({channels:[n],withPresence:!0}),e.props.pubnub.publish({message:{type:"addToPlayers",player:e.props.player},channel:n})},e.addToPlayers=function(){var a=Object(C.a)(v.a.mark((function a(n){return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.props.addToPlayers(n);case 2:e.props.pubnub.publish({message:{type:"updatePlayers",players:e.props.players},channel:e.props.lobbyChannel});case 3:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.updatePlayers=function(a){e.props.isHost||e.props.updatePlayers(a)},e.startGame=function(){e.props.isHost?e.props.players.length>1?(console.log("Starting game"),e.props.pubnub.publish({message:{type:"startGame"},channel:e.props.lobbyChannel})):(console.log("Please wait for at least one opponent."),O.a.fire("Please wait for at least one opponent.")):(console.log("You are NOT the host!!"),O.a.fire("Please wait for the host to start the game."))},e.playGame=function(){var a="coup-game-".concat(e.props.roomId);e.props.joinGame(a),e.props.pubnub.subscribe({channels:[a],withPresence:!0}),console.log("Joining gameChannel: ".concat(e.props.gameChannel)),console.log("Game start!!"),e.props.playGame()},e.testMsg=function(a){e.props.pubnub.publish({message:{type:"log",text:a},channel:e.props.lobbyChannel})},e.hereNow=function(){e.props.pubnub.hereNow({channels:[e.props.lobbyChannel]}).then(console.log)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){var e=this;this.props.lobbyChannel&&this.props.pubnub.getMessage(this.props.lobbyChannel,(function(a){switch(a.message.type){case"startGame":O.a.close(),e.playGame();break;case"log":console.log(a.message.text);break;case"addToPlayers":e.props.isHost&&e.addToPlayers(a.message.player);break;case"updatePlayers":e.updatePlayers(a.message.players);break;default:console.error("Unknown lobby message."),console.log(a)}}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("p",null,"Welcome, ",r.a.createElement("span",{style:{color:"red",fontSize:40}},this.props.player.username),"."),!this.props.lobbyChannel&&r.a.createElement("div",null,r.a.createElement("button",{onClick:this.createLobby,className:"createLobby"},"Create Room"),r.a.createElement("form",{onSubmit:function(a){return e.joinLobby(a)}},r.a.createElement("input",{type:"text",placeholder:"Enter Room ID"}),r.a.createElement("button",{type:"submit"},"Join Room"))),this.props.lobbyChannel&&r.a.createElement("div",null,r.a.createElement("p",null,"Room ID ",r.a.createElement("br",null),this.props.roomId),r.a.createElement("br",null),r.a.createElement("button",{onClick:this.startGame,className:"start"},"START"),r.a.createElement("br",null),r.a.createElement("div",{className:"lobby-player-list-container"},r.a.createElement("div",{className:"lobby-player-list"},r.a.createElement("p",{className:"lobby-player-list-title"},"Players"),this.props.players.map((function(e){return r.a.createElement("p",{key:e.id},e.username)}))))))}}]),n}(r.a.Component),D=Object(d.b)((function(e){return{pubnub:e.connectionReducer.pubnub,roomId:e.connectionReducer.roomId,lobbyChannel:e.connectionReducer.lobbyChannel,gameChannel:e.connectionReducer.gameChannel,isHost:e.connectionReducer.isHost,player:e.playerReducer,players:e.gameReducer.players}}),(function(e){return{setRoomId:function(a){return e({type:"setRoomId",roomId:a})},setHost:function(){return e({type:"setHost"})},joinLobby:function(a){return e({type:"joinLobby",lobbyChannel:a})},joinGame:function(a){return e({type:"joinGame",gameChannel:a})},addToPlayers:function(a){return e({type:"addToPlayers",player:a})},playGame:function(){return e({type:"playGame"})},updatePlayers:function(a){return e({type:"updatePlayers",players:a})}}}))(L),Y=function(e){Object(u.a)(n,e);var a=Object(p.a)(n);function n(){return Object(c.a)(this,n),a.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,!this.props.isPlaying&&r.a.createElement("div",null,r.a.createElement(D,null)),this.props.isPlaying&&r.a.createElement(U,null))}}]),n}(r.a.Component),S=Object(d.b)((function(e){return{pubnub:e.connectionReducer.pubnub,isPlaying:e.connectionReducer.isPlaying}}),(function(e){return{}}))(Y),H=function(e){Object(u.a)(n,e);var a=Object(p.a)(n);function n(e){var t;Object(c.a)(this,n),(t=a.call(this,e)).setUsername=function(e){e.preventDefault();var a=e.target[0].value;""!==a?t.props.setUsername(a):(O.a.fire("Please enter a username!"),console.error("Please enter a username!"))},t.pubnub=new g.a({publishKey:h,subscribeKey:y});var r=Math.random().toString(36).slice(2,12);return t.props.setId(r),t.pubnub.setUUID(r),t.pubnub.init(Object(i.a)(t)),t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.initPubnub(this.pubnub)}},{key:"componentWillUnmount",value:function(){this.props.pubnub.unsubscribe({channels:[this.props.lobbyChannel,this.props.gameChannel]})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},!this.props.username&&r.a.createElement("div",null,r.a.createElement("p",{className:"title"},"COUP REACT"),r.a.createElement("p",{style:{fontSize:"24px"}},"Enter name to play"),r.a.createElement("form",{onSubmit:function(a){return e.setUsername(a)}},r.a.createElement("input",{type:"text",placeholder:"Set Username"}),r.a.createElement("button",{type:"submit"},"Let's go!"))),this.props.username&&r.a.createElement(S,null))}}]),n}(r.a.Component),G=Object(d.b)((function(e){return{pubnub:e.connectionReducer.pubnub,lobbyChannel:e.connectionReducer.lobbyChannel,gameChannel:e.connectionReducer.gameChannel,username:e.playerReducer.username}}),(function(e){return{initPubnub:function(a){return e({type:"initPubnub",pubnub:a})},setId:function(a){return e({type:"setId",id:a})},setUsername:function(a){return e({type:"setUsername",username:a})}}}))(H);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var M=n(12),_={id:NaN,gameOver:!1,username:Math.random().toString(36).slice(2,5),hand:[],coins:2,actions:{income:{character:null,action:"Income",effect:"Take 1 coin",counteraction:null},foreignAid:{character:null,action:"Foreign Aid",effect:"Take 2 coins",counteraction:null},coup:{character:null,action:"Coup",effect:"Pay 7 coins - Choose player to lose influence",counteraction:null},tax:{character:"Duke",action:"Tax",effect:"Take 3 coins",counteraction:"Blocks Foreign Aid"},assassinate:{character:"Assassin",action:"Assassinate",effect:"Pay 3 coins - Choose player to lose influence",counteraction:null},exchange:{character:"Ambassador",action:"Exchange",effect:"Exchange cards with Court Deck",counteraction:"Blocks stealing"},steal:{character:"Captain",action:"Steal",effect:"Take 2 coins from another player",counteraction:"Blocks stealing"},contessa:{character:"Contessa",action:"X",effect:null,counteraction:"Blocks assassination"}}};var K={players:[],deck:[{id:1,name:"Duke",img_url:null,action:"Tax",effect:"Take 3 coins",counteraction:"Blocks Foreign Aid",description:"Take 3 coins from Treasury. Blocks Foreign Aid.",isRevealed:!1},{id:2,name:"Assassin",img_url:null,action:"Assassinate",effect:"Pay 3 coins - Choose player to lose influence",counteraction:"",description:"Pay 3 coins to assassinate another player.",isRevealed:!1},{id:3,name:"Ambassador",img_url:null,action:"Exchange",effect:"Exchange cards with Court Deck",counteraction:"Blocks stealing",description:"Exchange cards with Court Deck. Blocks stealing.",isRevealed:!1},{id:4,name:"Captain",img_url:null,action:"Steal",effect:"Take 2 coins from another player",counteraction:"Blocks stealing",description:"Steal 2 coins from another player. Blocks stealing.",isRevealed:!1},{id:5,name:"Contessa",img_url:null,action:"",effect:"",counteraction:"Blocks assassination",description:"Blocks assassination.",isRevealed:!1},{id:6,name:"Duke",img_url:null,action:"Tax",effect:"Take 3 coins",counteraction:"Blocks Foreign Aid",description:"Take 3 coins from Treasury. Blocks Foreign Aid.",isRevealed:!1},{id:7,name:"Assassin",img_url:null,action:"Assassinate",effect:"Pay 3 coins - Choose player to lose influence",counteraction:"",description:"Pay 3 coins to assassinate another player.",isRevealed:!1},{id:8,name:"Ambassador",img_url:null,action:"Exchange",effect:"Exchange cards with Court Deck",counteraction:"Blocks stealing",description:"Exchange cards with Court Deck. Blocks stealing.",isRevealed:!1},{id:9,name:"Captain",img_url:null,action:"Steal",effect:"Take 2 coins from another player",counteraction:"Blocks stealing",description:"Steal 2 coins from another player. Blocks stealing.",isRevealed:!1},{id:10,name:"Contessa",img_url:null,action:"",effect:"",counteraction:"Blocks assassination",description:"Blocks assassination.",isRevealed:!1},{id:11,name:"Duke",img_url:null,action:"Tax",effect:"Take 3 coins",counteraction:"Blocks Foreign Aid",description:"Take 3 coins from Treasury. Blocks Foreign Aid.",isRevealed:!1},{id:12,name:"Assassin",img_url:null,action:"Assassinate",effect:"Pay 3 coins - Choose player to lose influence",counteraction:"",description:"Pay 3 coins to assassinate another player.",isRevealed:!1},{id:13,name:"Ambassador",img_url:null,action:"Exchange",effect:"Exchange cards with Court Deck",counteraction:"Blocks stealing",description:"Exchange cards with Court Deck. Blocks stealing.",isRevealed:!1},{id:14,name:"Captain",img_url:null,action:"Steal",effect:"Take 2 coins from another player",counteraction:"Blocks stealing",description:"Steal 2 coins from another player. Blocks stealing.",isRevealed:!1},{id:15,name:"Contessa",img_url:null,action:"",effect:"",counteraction:"Blocks assassination",description:"Blocks assassination.",isRevealed:!1}],treasury:50,activePlayer:{},whosTurnIsIt:0};var F={pubnub:null,roomId:"",lobbyChannel:"",gameChannel:"",isHost:!1,isPlaying:!1};var W=Object(M.b)({connectionReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"initPubnub":return Object(f.a)({},e,{pubnub:a.pubnub});case"setRoomId":return Object(f.a)({},e,{roomId:a.roomId});case"setHost":return Object(f.a)({},e,{isHost:!0});case"joinLobby":return Object(f.a)({},e,{lobbyChannel:a.lobbyChannel});case"joinGame":return Object(f.a)({},e,{gameChannel:a.gameChannel});case"playGame":return Object(f.a)({},e,{isPlaying:!0});default:return e}},playerReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"setId":return Object(f.a)({},e,{id:a.id});case"setUsername":return Object(f.a)({},e,{username:a.username});case"getNewCard":return e.hand.push(a.card),e;case"updateHand":return Object(f.a)({},e,{hand:a.cards});case"updateCoins":return Object(f.a)({},e,{coins:e.coins+a.amt});case"gameOver":return Object(f.a)({},e,{gameOver:!0});case"revealCard":var n=JSON.parse(JSON.stringify(e.hand[a.i]));n.isRevealed=!0;var t=Object(k.a)(e.hand);return t[a.i]=n,Object(f.a)({},e,{hand:t});default:return e}},gameReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"initializeDeck":return Object(f.a)({},e,{deck:a.cards});case"updateDeck":return Object(f.a)({},e,{deck:a.updatedDeck});case"updatePlayer":var n=e.players.indexOf(e.players.find((function(e){return e.id===a.player.id}))),t=Object(k.a)(e.players);return t[n]=a.player,Object(f.a)({},e,{players:t});case"changeTreasury":return Object(f.a)({},e,{treasury:e.treasury+a.amt});case"updateTreasury":return Object(f.a)({},e,{treasury:a.treasury});case"addToPlayers":var r=Object(k.a)(e.players);return r.push(a.player),Object(f.a)({},e,{players:r});case"updatePlayers":return Object(f.a)({},e,{players:a.players});case"setActivePlayer":return Object(f.a)({},e,{activePlayer:e.players[e.whosTurnIsIt]});case"endTurn":do{e.whosTurnIsIt=(e.whosTurnIsIt+1)%e.players.length}while(!0===e.players[e.whosTurnIsIt].gameOver);return e;default:return e}}}),J=Object(M.c)(W);o.a.render(r.a.createElement(d.a,{store:J},r.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[25,1,2]]]);
//# sourceMappingURL=main.50589af3.chunk.js.map